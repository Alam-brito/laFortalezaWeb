import{i as F,S as M,C as p,r as b,j as D,c as n,a as e,h as f,b as G,f as Q,F as h,k as x,u as k,o as l,t as m,l as _,v as S,I as q,d as J}from"./app-BBDfuzFB.js";import{S as i}from"./sweetalert2-z6gKu1nJ.js";const K={class:"relative overflow-x-auto shadow-lg sm:rounded-lg mx-4 mt-4 bg-white dark:bg-gray-900 transition-all duration-300"},O={class:"bg-white dark:bg-gray-800 p-6 rounded-xl"},W={class:"grid md:grid-cols-2 gap-6 mb-8"},X={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl shadow-inner"},Y={class:"space-y-3"},Z={class:"text-gray-700 dark:text-gray-200"},I=["onClick"],ee={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl shadow-inner"},oe={class:"space-y-3"},te={class:"text-gray-700 dark:text-gray-200"},re=["onClick"],se={class:"grid md:grid-cols-2 gap-4"},ne={class:"space-y-2"},le=["disabled"],ie={key:0},ae={key:1,class:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24"},de={class:"space-y-2"},ce=["disabled"],ue={key:0},ge={key:1,class:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24"},me={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},pe={class:"px-6 py-4 font-medium text-gray-900 dark:text-white"},fe={class:"px-6 py-4"},he={class:"px-6 py-4 space-y-2"},xe={class:"flex flex-wrap gap-2"},ve={class:"relative mt-2"},ye=["onUpdate:modelValue"],be=["value"],ke=["onClick","disabled"],we={class:"px-6 py-4"},Ce={class:"max-h-40 overflow-y-auto p-2 bg-gray-50 dark:bg-gray-700 rounded-lg"},_e={class:"inline-flex items-center"},Be=["value","checked","onChange"],Ee={class:"w-5 h-5 border-2 border-gray-300 dark:border-gray-500 rounded-md flex items-center justify-center transition-colors"},je={key:0,class:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ae={class:"text-gray-700 dark:text-gray-200 text-sm"},Me={class:"px-6 py-4"},Se={class:"flex flex-col gap-2"},Ve=["onClick"],Ne=["onClick"],Ue={__name:"ListaUsuarios",setup(Re){const{users:B,roles:E,permisos:j}=F().props,c=M({}),a=M({}),A=p({});B.forEach(r=>{c[r.id]=r.roles.length>0?r.roles:[],a[r.id]=r.permisos});const v=b(""),y=b(""),w=b(!1),C=b(!1),V=r=>{const o=Array.isArray(c[r])?[...new Set(c[r])]:[c[r]],u=Array.isArray(a[r])?[...new Set(a[r])]:[a[r]],t=o.map(g=>parseInt(g)).filter(g=>!isNaN(g)),s=u.filter(g=>g);p({roles:t,permisos:s}).put(route("admin.usuarios.update",r),{onSuccess:()=>{i.fire({title:"¡Éxito!",text:"Rol y permisos actualizados correctamente.",icon:"success",confirmButtonText:"Aceptar",timer:3e3,timerProgressBar:!0}),location.reload()},onError:g=>{console.log(g),i.fire({title:"Error",text:"Hubo un problema al actualizar el rol y permisos.",icon:"error",confirmButtonText:"Aceptar"})}})},N=()=>{v.value.trim()&&(w.value=!0,p({nombre:v.value}).post(route("admin.roles.store"),{onSuccess:()=>{d.value=!1,i.fire("¡Éxito!","Rol agregado.","success"),v.value="",location.reload()},onError:()=>{i.fire("Error","No se pudo agregar.","error")},onFinish:()=>{w.value=!1}}))},R=()=>{y.value.trim()&&(C.value=!0,p({nombre:y.value}).post(route("admin.permisos.store"),{onSuccess:()=>{d.value=!1,i.fire("¡Éxito!","Permiso agregado.","success"),y.value="",location.reload()},onError:()=>{i.fire("Error","No se pudo agregar.","error")},onFinish:()=>{C.value=!1}}))},P=r=>{d.value=!1,i.fire({title:"¿Estás seguro?",text:"¡Este rol será eliminado permanentemente!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&A.delete(route("admin.roles.delete",r),{onSuccess:()=>{d.value=!1,i.fire("¡Eliminado!","El rol ha sido eliminado.","success"),location.reload()},onError:()=>{i.fire("Error","No se pudo eliminar el rol.","error")}})})},T=r=>{d.value=!1,i.fire({title:"¿Estás seguro?",text:"¡Este permiso será eliminado permanentemente!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&A.delete(route("admin.permisos.delete",r),{onSuccess:()=>{d.value=!1,i.fire("¡Eliminado!","El permiso ha sido eliminado.","success"),location.reload()},onError:()=>{i.fire("Error","No se pudo eliminar el permiso.","error")}})})},U=(r,o)=>{a[r].includes(o)?a[r]=a[r].filter(u=>u!==o):a[r].push(o)},L=r=>{i.fire({title:"¿Estás seguro?",text:"No podrás deshacer esta acción.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&p({}).delete(route("admin.usuarios.delete",r),{onSuccess:()=>{i.fire({title:"¡Eliminado!",text:"El usuario ha sido eliminado correctamente.",icon:"success",confirmButtonText:"Aceptar",timer:3e3,timerProgressBar:!0}),location.reload()},onError:()=>{i.fire({title:"Error",text:"Hubo un problema al eliminar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}})})},d=b(!1),z=()=>{d.value=!0},H=(r,o)=>{o&&i.fire({title:"¿Estás seguro?",text:"Este rol será eliminado del usuario.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(u=>{u.isConfirmed&&p({}).delete(route("admin.usuarios.removerRol",{userId:r,rolId:o}),{onSuccess:()=>{i.fire("¡Eliminado!","El rol ha sido eliminado.","success"),location.reload()},onError:()=>{i.fire("Error","No se pudo eliminar el rol.","error")}})})};return(r,o)=>{const u=D("el-dialog");return l(),n("div",K,[e("div",{class:"flex justify-end p-4"},[e("button",{onClick:z,class:"flex items-center bg-gradient-to-r from-indigo-500 to-blue-600 hover:from-indigo-600 hover:to-blue-700 text-white px-6 py-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1"},o[3]||(o[3]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),f(" Administrar Roles y Permisos ")]))]),G(u,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=t=>d.value=t),width:"800px",class:"dark:bg-gray-800 rounded-2xl overflow-hidden","modal-class":"transition-all duration-300"},{default:Q(()=>[e("div",O,[o[10]||(o[10]=e("h2",{class:"text-2xl font-bold text-gray-800 dark:text-white mb-6 flex items-center gap-2"},[e("svg",{class:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]),f(" Gestión de Roles y Permisos ")],-1)),e("div",W,[e("div",X,[o[5]||(o[5]=e("h3",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Roles",-1)),e("div",Y,[(l(!0),n(h,null,x(k(E),t=>(l(),n("div",{key:t.id,class:"flex items-center justify-between bg-white dark:bg-gray-600 p-3 rounded-lg shadow-sm hover:shadow-md transition-shadow"},[e("span",Z,m(t.nombre),1),e("button",{onClick:s=>P(t.id),class:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-50"},o[4]||(o[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,I)]))),128))])]),e("div",ee,[o[7]||(o[7]=e("h3",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Permisos",-1)),e("div",oe,[(l(!0),n(h,null,x(k(j),t=>(l(),n("div",{key:t.id,class:"flex items-center justify-between bg-white dark:bg-gray-600 p-3 rounded-lg shadow-sm hover:shadow-md transition-shadow"},[e("span",te,m(t.nombre),1),e("button",{onClick:s=>T(t.id),class:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-50"},o[6]||(o[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,re)]))),128))])])]),e("div",se,[e("div",ne,[_(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>v.value=t),placeholder:"Nuevo rol",class:"w-full px-4 py-2 border-2 border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-all"},null,512),[[S,v.value]]),e("button",{onClick:N,disabled:w.value,class:"w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-all flex items-center justify-center"},[w.value?(l(),n("svg",ae,o[8]||(o[8]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(l(),n("span",ie,"Agregar Rol"))],8,le)]),e("div",de,[_(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>y.value=t),placeholder:"Nuevo permiso",class:"w-full px-4 py-2 border-2 border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-all"},null,512),[[S,y.value]]),e("button",{onClick:R,disabled:C.value,class:"w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-all flex items-center justify-center"},[C.value?(l(),n("svg",ge,o[9]||(o[9]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(l(),n("span",ue,"Agregar Permiso"))],8,ce)])])])]),_:1},8,["modelValue"]),e("table",me,[o[18]||(o[18]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-100 dark:bg-gray-700 dark:text-gray-300"},[e("tr",null,[e("th",{class:"px-6 py-4"},"Usuario"),e("th",{class:"px-6 py-4"},"Email"),e("th",{class:"px-6 py-4"},"Roles"),e("th",{class:"px-6 py-4"},"Permisos"),e("th",{class:"px-6 py-4"},"Acciones")])],-1)),e("tbody",null,[(l(!0),n(h,null,x(k(B),t=>(l(),n("tr",{key:t.id,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[e("td",pe,m(t.name),1),e("td",fe,m(t.email),1),e("td",he,[e("div",xe,[(l(!0),n(h,null,x(t.roles,s=>(l(),n("span",{key:s,class:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full flex items-center gap-1"},[o[11]||(o[11]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),f(" "+m(s),1)]))),128))]),e("div",ve,[_(e("select",{"onUpdate:modelValue":s=>c[t.id]=s,class:"w-full px-3 py-2 border-2 border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white appearance-none focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8"},[o[12]||(o[12]=e("option",{value:"",disabled:""},"Seleccionar rol",-1)),(l(!0),n(h,null,x(k(E),s=>(l(),n("option",{key:s.id,value:s.id,class:"dark:bg-gray-700"},m(s.nombre),9,be))),128))],8,ye),[[q,c[t.id]]]),o[13]||(o[13]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-400"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),e("button",{onClick:s=>H(t.id,c[t.id]),class:"mt-2 w-full px-3 py-1.5 text-sm bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors flex items-center justify-center gap-1",disabled:!c[t.id]},o[14]||(o[14]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),f(" Quitar Rol ")]),8,ke)]),e("td",we,[e("div",Ce,[(l(!0),n(h,null,x(k(j),s=>(l(),n("div",{key:s.id,class:"flex items-center gap-3 p-2 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-md transition-colors"},[e("label",_e,[e("input",{type:"checkbox",value:s.nombre,checked:a[t.id].includes(s.nombre),onChange:$=>U(t.id,s.nombre),class:"hidden"},null,40,Be),e("div",Ee,[a[t.id].includes(s.nombre)?(l(),n("svg",je,o[15]||(o[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):J("",!0)])]),e("span",Ae,m(s.nombre),1)]))),128))])]),e("td",Me,[e("div",Se,[e("button",{onClick:s=>V(t.id),class:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center justify-center gap-2 transition-transform hover:scale-105"},o[16]||(o[16]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),f(" Guardar ")]),8,Ve),e("button",{onClick:s=>L(t.id),class:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg flex items-center justify-center gap-2 transition-transform hover:scale-105"},o[17]||(o[17]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),f(" Eliminar ")]),8,Ne)])])]))),128))])])])}}};export{Ue as default};
