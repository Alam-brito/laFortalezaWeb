import{r as b,x as _,e as z,f,o as l,a as e,t,c as d,d as c,F as y,k,n as H,h as p,b as M,u as N,P as T,K as w}from"./app-D9ZzZpws.js";import $ from"./UserLayouts-D09G3Oat.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BwjxXh1V.js";import"./Header-ygBdPDG8.js";import"./sweetalert2-z6gKu1nJ.js";import"./Footer-2ZYT8siL.js";const q={class:"min-h-screen bg-gradient-to-br from-teal-50 to-yellow-50 dark:from-gray-900 dark:to-gray-800 py-8"},A={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},G={class:"mb-8"},I={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6"},K={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},O={class:"text-gray-600 dark:text-gray-400"},J={class:"mt-4 sm:mt-0 text-right"},Q={class:"text-2xl font-bold text-teal-600 dark:text-teal-400"},R={class:"text-sm text-gray-500 dark:text-gray-400"},U={key:0,class:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},W={class:"flex"},X={class:"text-red-800 dark:text-red-200"},Y={key:1,class:"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},Z={class:"flex"},ee={class:"text-blue-800 dark:text-blue-200"},te={key:2,class:"space-y-6"},se={class:"bg-gradient-to-r from-teal-500 to-teal-600 dark:from-teal-700 dark:to-teal-800 px-6 py-4"},ae={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},re={class:"flex items-center space-x-3"},oe={class:"text-lg font-semibold text-white"},le={class:"text-teal-100"},ne={class:"mt-3 sm:mt-0 flex items-center space-x-4"},de={class:"text-right"},ie={class:"text-2xl font-bold text-white"},ce={class:"text-teal-100 text-sm"},xe={class:"p-6"},ue={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4"},ge={class:"flex-shrink-0"},me=["src","alt"],be={class:"flex-1 min-w-0"},ve={class:"text-sm font-semibold text-gray-900 dark:text-white truncate"},he={class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},_e={class:"flex items-center justify-between"},fe={class:"text-sm text-gray-600 dark:text-gray-300"},ye={class:"text-sm font-medium text-teal-600 dark:text-teal-400"},ke={key:0,class:"text-xs text-green-600 dark:text-green-400"},pe={key:0,class:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},we={class:"text-sm text-blue-800 dark:text-blue-200"},Ce={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between pt-4 border-t border-gray-200 dark:border-gray-600"},je={class:"text-sm text-gray-500 dark:text-gray-400 mb-3 sm:mb-0"},Ee=["onClick"],Be={key:3,class:"text-center py-12"},De={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8"},Le={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Ve={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-md w-full"},Se={class:"text-center"},Fe={class:"text-gray-600 dark:text-gray-400 mb-6"},ze={class:"flex space-x-4"},He=["disabled"],Me={__name:"Historial",props:{historial:Array,cliente_nombre:String,error:String,mensaje:String},setup(n){const v=n,x=b(!1),u=b(!1),i=b(null),C=_(()=>{var a;return((a=v.historial)==null?void 0:a.length)||0}),j=_(()=>{var a;return((a=v.historial)==null?void 0:a.reduce((s,g)=>s+parseFloat(g.venta.total),0).toFixed(2))||"0.00"}),E=a=>new Date(a).toLocaleDateString("es-BO",{year:"numeric",month:"long",day:"numeric"}),m=a=>`Bs ${parseFloat(a).toFixed(2)}`,B=a=>{switch(a.toLowerCase()){case"qr":return"üì±";case"efectivo":return"üíµ";case"tarjeta":return"üí≥";default:return"üí∞"}},D=a=>{switch(a.toLowerCase()){case"completado":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"pendiente":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"cancelado":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}},L=a=>{i.value=a,u.value=!0},V=async()=>{if(i.value){x.value=!0;try{await w.delete(`/historial/${i.value.venta.venta_id}`,{onSuccess:()=>{u.value=!1,i.value=null,w.reload()},onError:a=>{console.error("Error al eliminar:",a),alert("Error al eliminar la venta")}})}catch(a){console.error("Error:",a),alert("Error al eliminar la venta")}finally{x.value=!1}}},S=()=>{u.value=!1,i.value=null};return(a,s)=>(l(),z($,null,{default:f(()=>{var g;return[e("div",q,[e("div",A,[e("div",G,[e("div",I,[e("div",K,[e("div",null,[s[1]||(s[1]=e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-2"}," üìã Historial de Compras ",-1)),e("p",O," Bienvenido "+t(n.cliente_nombre)+", aqu√≠ puedes ver todas tus compras ",1)]),e("div",J,[e("div",Q,t(m(j.value)),1),e("div",R," Total gastado en "+t(C.value)+" compras ",1)])])])]),n.error?(l(),d("div",U,[e("div",W,[e("div",X," ‚ùå "+t(n.error),1)])])):c("",!0),n.mensaje?(l(),d("div",Y,[e("div",Z,[e("div",ee," ‚ÑπÔ∏è "+t(n.mensaje),1)])])):c("",!0),n.historial&&n.historial.length>0?(l(),d("div",te,[(l(!0),d(y,null,k(n.historial,(r,Ne)=>{var h;return l(),d("div",{key:r.venta.venta_id,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300"},[e("div",se,[e("div",ae,[e("div",re,[s[2]||(s[2]=e("div",{class:"bg-white/20 rounded-full p-2"},[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1)),e("div",null,[e("h3",oe," Compra #"+t(r.venta.venta_id),1),e("p",le,t(E(r.venta.fecha)),1)])]),e("div",ne,[e("div",de,[e("div",ie,t(m(r.venta.total)),1),e("div",ce,t(B(r.venta.tipo_pago))+" "+t(r.venta.tipo_pago),1)]),e("span",{class:H(["px-3 py-1 rounded-full text-xs font-medium",D(r.venta.estado_pago)])},t(r.venta.estado_pago),3)])])]),e("div",xe,[e("div",ue,[(l(!0),d(y,null,k(r.productos,o=>(l(),d("div",{key:o.producto_id,class:"flex items-center space-x-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-xl"},[e("div",ge,[e("img",{src:o.imagen_url,alt:o.producto_nombre,class:"w-16 h-16 object-cover rounded-lg shadow-md",onError:s[0]||(s[0]=F=>F.target.src="/images/no-image.png")},null,40,me)]),e("div",be,[e("h4",ve,t(o.producto_nombre),1),e("p",he,t(o.categoria_nombre),1),e("div",_e,[e("span",fe," Cant: "+t(o.cantidad),1),e("span",ye,t(m(o.subtotal_final)),1)]),o.descuento?(l(),d("div",ke," üè∑Ô∏è "+t(o.descuento)+"% descuento ",1)):c("",!0)])]))),128))]),r.productos.some(o=>o.descripcion_venta)?(l(),d("div",pe,[e("p",we," üìù "+t((h=r.productos.find(o=>o.descripcion_venta))==null?void 0:h.descripcion_venta),1)])):c("",!0),e("div",Ce,[e("div",je,t(r.total_productos)+" producto"+t(r.total_productos!==1?"s":"")+" ‚Ä¢ "+t(r.cantidad_total)+" unidad"+t(r.cantidad_total!==1?"es":""),1),e("button",{onClick:o=>L(r),class:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"},s[3]||(s[3]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),p(" Eliminar compra ")]),8,Ee)])])])}),128))])):!n.error&&!n.mensaje?(l(),d("div",Be,[e("div",De,[s[5]||(s[5]=e("div",{class:"text-6xl mb-4"},"üõí",-1)),s[6]||(s[6]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," No tienes compras a√∫n ",-1)),s[7]||(s[7]=e("p",{class:"text-gray-600 dark:text-gray-400 mb-6"}," ¬°Comienza a explorar nuestros productos y realiza tu primera compra! ",-1)),M(N(T),{href:a.route("user.home"),as:"button",type:"button",class:"inline-flex items-center px-6 py-3 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg transition-colors"},{default:f(()=>s[4]||(s[4]=[p(" Ver productos ")])),_:1},8,["href"])])])):c("",!0)])]),u.value?(l(),d("div",Le,[e("div",Ve,[e("div",Se,[s[8]||(s[8]=e("div",{class:"text-6xl mb-4"},"‚ö†Ô∏è",-1)),s[9]||(s[9]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," ¬øEliminar compra? ",-1)),e("p",Fe," Esta acci√≥n no se puede deshacer. La compra #"+t((g=i.value)==null?void 0:g.venta.venta_id)+" ser√° eliminada permanentemente. ",1),e("div",ze,[e("button",{onClick:S,class:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors"}," Cancelar "),e("button",{onClick:V,disabled:x.value,class:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50"},t(x.value?"Eliminando...":"Eliminar"),9,He)])])])])):c("",!0)]}),_:1}))}},Ke=P(Me,[["__scopeId","data-v-941ab12d"]]);export{Ke as default};
